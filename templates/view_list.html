{% extends "base.html" %}

{% block title %}Lists{% endblock %}

{% block content %}

{% for message in get_flashed_messages() %}

<div class="alert alert-dark alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

{% endfor %}
<br><br><br>
{% for member in group %}
{% if member.user_id == current_user.id %}
<a href="{{ url_for('add_task', list_id=list_id) }}" class="btn btn-dark">Add Task</a>
<a href="{{ url_for('lists') }}" class="btn btn-dark">Back</a>
<br>
<table class="table table-striped table-hover">
    <th scope="col">Task Name</th>
    <th scope="col">Priority</th>
    <th scope="col">Due Date</th>
    <th scope="col">Status</th>
    <th scope="col"></th>
    {% for task in tasks %}
    <tr>
        <td>{{ task.task_name }}</td>
        <td>{{ task.priority }}</td>
        <td>{{ task.due_date.strftime('%Y-%m-%d')}}</td>
        <td>{% if task.finished %}
            <p class="btn btn-success">Finished</p>
            {% elif task.due_date.date() >= today %}
            <p class="btn btn-info">In Progress</p>
            {% else %}
            <p class="btn btn-danger">Overdue</p>
            {% endif %}
        </td>
        <td><a href="{{ url_for('edit_task', list_id=list_id, task_id=task.task_id )}}" class="btn btn-dark">Edit</a>
        </td>
        <td><a href="{{ url_for('delete_task', list_id=list_id, task_id=task.task_id )}}"
                class="btn btn-dark">Delete</a>
        </td>
    </tr>
    {% endfor %}
</table>

{% else %}

<div class="alert alert-dark alert-dismissible fade show" role="alert">
    You can't view this list
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

{% endif %}

{% endfor %}
{% endblock %}